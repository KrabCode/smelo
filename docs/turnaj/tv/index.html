<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blind Tracker ‚Äì SMELO.CZ</title>
    <link rel="icon" type="image/x-icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../base.css">
    <link rel="stylesheet" href="style.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
</head>
<body>
    <!-- Header -->
    <div class="tracker-header">
        <span class="conn-dot" id="conn-dot"></span>
        <div class="stat-item">Buy-in: <span id="hd-buyin-amount">400 Kƒç</span></div>
        <div class="stat-item">≈Ωetony: <span id="hd-chips">0</span></div>
        <div class="stat-item" style="display:none">Prize pool: <span id="hd-pool">0 Kƒç</span> / <span id="hd-places">0</span> <span id="hd-places-label">v√Ωherc≈Ø</span></div>
        <div class="stat-item">Hr√°ƒçi: <span id="hd-active">0</span> / <span id="hd-buyin">0</span></div>
        <div class="stat-item">Pr≈Ømƒõrn√Ω stack: <span id="hd-avg">0</span></div>
        <div class="header-controls" id="header-controls">
            <div class="table-tabs" id="table-tabs"></div>
            <button id="btn-toggle-seating" title="Zobrazit/skr√Ωt st≈Øl"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
            <button id="btn-toggle-admin" title="Admin re≈æim"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></button>
            <button id="zoom-out"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg></button>
            <button id="zoom-in"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></button>
            <button id="btn-fullscreen" title="Cel√° obrazovka"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg></button>
            <button id="btn-test-sound" title="Test zvuku"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button>
            <button id="btn-mute" title="Ztlumit"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg></button>
            <button id="btn-toggle-ticker" title="Zobrazit/skr√Ωt ticker"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="8" x2="21" y2="8"/><line x1="3" y1="16" x2="15" y2="16"/></svg></button>
        </div>
    </div>
    <div class="main-content">
        <!-- Left sidebar: Blind structure -->
        <div class="sidebar sidebar-left">
            <div class="structure-wrap">
                <table class="structure-table">
                    <thead>
                        <tr><th>Level</th><th>ƒåas</th><th>SB</th><th>BB</th><th id="th-ante" style="display:none">Ante</th></tr>
                    </thead>
                    <tbody id="structure-body"></tbody>
                </table>
            </div>
        </div>

        <!-- Display -->
        <div class="display" id="display">
            <div class="timer" id="timer">00:00</div>
            <div class="progress-wrap"><div class="progress-bar" id="progress-bar"></div></div>
            <div class="blinds-label" id="blinds-label">BLINDY</div>
            <div class="blinds-current" id="blinds-current">‚Äì / ‚Äì</div>
            <div class="blinds-sub" id="blinds-sub"></div>
            <div class="addon-banner" id="addon-banner" style="display:none"></div>
            <div class="break-message" id="break-message" style="display:none"></div>
            <div class="next-level" id="next-level"></div>
        </div>

        <!-- Winner banner (shown when all places declared) -->
        <div class="winner-banner" id="winner-banner" style="display:none">
            <div class="winner-label">V√ùSLEDKY TURNAJE</div>
            <div id="winner-list"></div>
        </div>

        <!-- Right sidebar: Payout + player count + seating -->
        <div class="sidebar sidebar-right">
            <div class="payout-section" id="payout-section">
                <table class="payout-table">
                    <thead><tr><th>M√≠sto</th><th>%</th><th>V√Ωhra</th></tr></thead>
                    <tbody id="payout-body"></tbody>
                </table>
            </div>
            <div class="players-remaining" id="players-remaining">
                <span class="players-remaining-label" id="remaining-verb">zb√Ωv√°</span>
                <span class="players-remaining-count" id="remaining-count">0</span>
                <span class="players-remaining-label" id="remaining-noun">hr√°ƒç≈Ø</span>
            </div>
            <div class="seating-section">
                <div class="seating-table-visual" id="seating-table-visual"></div>
            </div>
        </div>
    </div><!-- .main-content -->

    <!-- Admin panel (only with ?admin) -->
    <div class="admin-panel" id="admin-panel" style="display:none">
        <details>
            <summary>ADMIN OVL√ÅD√ÅN√ç</summary>

            <!-- Tournament config (frozen when running) -->
            <div class="admin-section" id="section-config">
                <h3>Nastaven√≠ turnaje</h3>
                <div class="config-grid">
                    <div class="config-sub">Struktura</div>
                    <div class="config-field">
                        <label>D√©lka levelu (min)</label>
                        <input type="number" id="cfg-level-dur" value="20">
                    </div>
                    <div class="config-field">
                        <label>Max level≈Ø</label>
                        <input type="number" id="cfg-max-levels" value="12" min="2">
                    </div>
                    <div class="config-field">
                        <label>Min SB</label>
                        <input type="number" id="cfg-smallest" value="25">
                    </div>
                    <div class="config-field">
                        <label>Max BB</label>
                        <input type="number" id="cfg-max-bb" value="10000" min="100">
                    </div>
                    <div class="config-field">
                        <label>Ante (√ó BB)</label>
                        <input type="number" id="cfg-ante-mult" value="0" min="0" max="10" step="0.5">
                    </div>
                    <div class="config-field">
                        <label>Orientaƒçn√≠ zaƒç√°tek</label>
                        <input type="time" id="cfg-start-time-est" value="19:00" step="60">
                    </div>
                    <div class="config-field config-full-row">
                        <label><button type="button" class="guard-toggle" id="guard-blind-curve">üîí</button> K≈ôivka blind≈Ø: <span id="blind-curve-val">1.0</span></label>
                        <input type="range" id="cfg-blind-curve" min="0.5" max="2.0" step="0.1" value="1.0" disabled>
                        <small class="config-hint">0.7 = rychl√Ω start | 1.0 = rovnomƒõrn√Ω r≈Øst | 1.3 = rychl√Ω konec</small>
                    </div>
                    <div class="config-sub">P≈ôest√°vka</div>
                    <div class="config-field">
                        <label>D√©lka p≈ôest√°vky (min)</label>
                        <input type="number" id="cfg-break-dur" value="30" min="1">
                    </div>
                    <div class="config-field">
                        <label>P≈ôest√°vka ka≈æd√Ωch N level≈Ø (0 = ≈æ√°dn√°)</label>
                        <input type="number" id="cfg-levels-per-break" value="0" min="0">
                    </div>
                    <div class="config-sub">≈Ωetony</div>
                    <div class="config-field">
                        <label>Buy-in (Kƒç)</label>
                        <input type="number" id="cfg-buyin-amount" value="400">
                    </div>
                    <div class="config-field">
                        <label>Poƒç√°teƒçn√≠ ≈æetony hr√°ƒçe</label>
                        <input type="number" id="cfg-stack" value="5000">
                    </div>
                    <div class="config-field">
                        <label>Bonus ≈æetony za vƒçasn√Ω p≈ô√≠chod</label>
                        <input type="number" id="cfg-bonus" value="5000">
                    </div>
                    <div class="config-sub">Add-on</div>
                    <div class="config-field">
                        <label>Add-on cena (Kƒç)</label>
                        <input type="number" id="cfg-addon-amount" value="0" min="0">
                    </div>
                    <div class="config-field">
                        <label>Add-on ≈æetony</label>
                        <input type="number" id="cfg-addon-chips" value="0" min="0">
                    </div>
                </div>
                <div class="save-status" id="config-save-status"></div>
            </div>

            <!-- Player list -->
            <div class="admin-section" id="section-players">
                <h3><button type="button" class="guard-toggle" id="guard-players">üîí</button> Hr√°ƒçi</h3>
                <div class="player-add-row">
                    <input type="text" id="new-player-name" placeholder="Jm√©no hr√°ƒçe...">
                    <button class="btn" id="btn-add-player">+ Hr√°ƒç</button>
                    <button class="btn" id="btn-add-test-players">+ Test (8)</button>
                    <button class="btn danger" id="btn-remove-all-players">Smazat v≈°e</button>
                </div>
                <div id="players-list"></div>
                <div id="player-summary" class="player-summary"></div>
            </div>

            <!-- Table locks -->
            <div class="admin-section" id="section-table-locks">
                <h3><button type="button" class="guard-toggle" id="guard-seating">üîí</button> Zasedac√≠ po≈ô√°dek</h3>
                <div id="table-locks-ui"></div>
                <div class="btn-row" style="margin-top:12px">
                    <button class="btn" id="btn-reshuffle-seats">P≈ôepoƒç√≠tat</button>
                </div>
                <p class="config-hint" style="margin-top:12px">Kdy≈æ jeden st≈Øl m√° o 2 hr√°ƒçe m√©nƒõ ne≈æ jin√Ω, zva≈æme p≈ôem√≠stit nejchud≈°√≠ho hr√°ƒçe z plnƒõj≈°√≠ho stolu k pr√°zdnƒõj≈°√≠mu ‚Äî z≈Østane tak na v≈°ech stolech relativnƒõ stejnƒõ ≈æeton≈Ø.</p>
            </div>

            <!-- Payout config -->
            <div class="admin-section" id="section-payout-config">
                <h3><button type="button" class="guard-toggle" id="guard-payout">üîí</button> V√Ωplaty</h3>
                <div id="payout-config-rows"></div>
                <div class="btn-row" style="margin-top:8px">
                    <button class="btn" id="btn-payout-add">+ M√≠sto</button>
                    <button class="btn" id="btn-payout-remove">‚àí M√≠sto</button>
                    <button class="btn" id="btn-payout-auto">Auto</button>
                </div>
                <div class="payout-config-total" id="payout-config-total"></div>
            </div>

            <!-- Winners -->
            <div class="admin-section" id="section-winners">
                <h3><button type="button" class="guard-toggle" id="guard-winners">üîí</button> V√Ωsledky</h3>
                <div id="winners-fields"></div>
                <div class="btn-row" style="margin-top:8px">
                    <button class="btn accent" id="btn-save-winners">Ukonƒçit turnaj</button>
                </div>
            </div>

            <!-- Timer controls -->
            <div class="admin-section" id="section-timer">
                <h3><button type="button" class="guard-toggle" id="guard-timer">üîí</button> Timer</h3>
                <div class="btn-row">
                    <button class="btn accent" id="btn-start">Start</button>
                    <button class="btn danger" id="btn-reset">Reset</button>
                </div>
                <div id="start-time-row" style="display:none;margin-top:10px">
                    <div class="config-field">
                        <label>ƒåas startu (posun timeru)</label>
                        <div style="display:flex;gap:6px;align-items:center">
                            <input type="time" id="cfg-start-time" step="60">
                            <button class="btn" id="btn-set-start-time" style="flex:0 0 auto;min-width:auto;padding:8px 12px">Nastavit</button>
                            <button class="btn" id="btn-level-back" style="flex:0 0 auto;min-width:auto;padding:8px 12px" title="Posunout o level zpƒõt">‚óÄ</button>
                            <button class="btn" id="btn-level-fwd" style="flex:0 0 auto;min-width:auto;padding:8px 12px" title="Posunout o level vp≈ôed">‚ñ∂</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes (ticker) -->
            <div class="admin-section">
                <h3>Pozn√°mky (ticker)</h3>
                <div id="notes-list"></div>
                <div class="btn-row" style="margin-top:8px">
                    <button class="btn" id="btn-add-note">+ Pozn√°mka</button>
                    <span class="save-status" id="notes-save-status"></span>
                </div>
                <div class="config-field" style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.06);padding-top:12px">
                    <label>Text p≈ôi p≈ôest√°vce</label>
                    <textarea id="cfg-break-message" rows="6" placeholder="Nap≈ô. Obƒçerstven√≠ v kuchyni..." style="width:100%"></textarea>
                    <span class="save-status" id="break-save-status"></span>
                </div>
            </div>
        </details>
    </div>

    <div class="tracker-footer" id="tracker-footer"><span class="ticker-track"><span class="ticker-half" id="ticker-a"></span><span class="ticker-half" id="ticker-b"></span></span></div>

    <script src="app.js"></script>
</body>
</html>
