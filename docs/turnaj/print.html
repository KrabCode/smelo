<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turnaj – SMELO.CZ</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Staatliches&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: #fff;
            color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm 30mm;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        h1 {
            font-family: 'Staatliches', sans-serif;
            font-size: 6rem;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: #1a1a1a;
            margin-bottom: 0.1em;
        }

        .divider {
            width: 160px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #1a1a1a, transparent);
            margin: 0.6em 0 1em;
        }

        .date {
            font-size: 1.5rem;
            color: #444;
            letter-spacing: 0.08em;
        }

        .time {
            margin-top: 0.3em;
            font-family: 'Staatliches', sans-serif;
            font-size: 2.4rem;
            letter-spacing: 0.15em;
            color: #1a1a1a;
        }

        #fish-container {
            width: 400px;
            height: 250px;
            margin: 2em 0;
        }

        #fish-container canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .details {
            font-size: 1.1rem;
            line-height: 2.2;
            color: #555;
        }

        .details span {
            color: #1a1a1a;
            font-weight: 700;
        }

        .url {
            margin-top: 2.5em;
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            color: #1a1a1a;
            text-decoration: underline;
        }

        @media print {
            body { background: #fff; }
            .page {
                padding: 0;
                width: 100%;
                height: 100vh;
            }
        }

        @media screen and (max-width: 600px) {
            .page {
                width: 100%;
                min-height: 100vh;
                padding: 20mm 10mm;
            }
            h1 { font-size: 3.5rem; }
            .time { font-size: 1.8rem; }
            .date { font-size: 1.2rem; }
            .details { font-size: 0.95rem; }
            #fish-container { width: 280px; height: 175px; }
        }
    </style>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>
    <div class="page">
        <h1><span style="font-size: 0.45em; letter-spacing: 0.35em;">Pokerový</span><br>Turnaj</h1>
        <div class="divider"></div>
        <div class="date">Sobota 28. února</div>
        <div class="time">19:00 – 23:30</div>
        <div id="fish-container"></div>
        <div class="details">
            Buy-in: <span>400</span><br>
            Re-buy možný do <span>21:30</span><br>
            Přestávka <span>21:00</span>–<span>21:30</span><br>
            Prvních <span>25%</span> hráčů vyhrává<br>
            Vítěz získá <span>40%</span> vkladů<br>
            Po turnaji Cash Game
        </div>
        <div class="url">smelo.cz/turnaj</div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import * as SkeletonUtils from 'three/addons/utils/SkeletonUtils.js';

        const container = document.getElementById('fish-container');
        const width = container.clientWidth;
        const height = container.clientHeight;

        // Renderer with white background and transparency for print
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, preserveDrawingBuffer: true });
        renderer.setSize(width, height);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.4;
        container.appendChild(renderer.domElement);

        const scene = new THREE.Scene();
        // Transparent background for white page
        scene.background = null;

        const camera = new THREE.PerspectiveCamera(35, width / height, 0.1, 100);
        camera.position.set(0, 1.5, 5);
        camera.lookAt(0, 0, 0);

        // Lighting — bright and soft for white design
        scene.add(new THREE.AmbientLight(0xffffff, 1.2));

        const keyLight = new THREE.DirectionalLight(0xffeedd, 2.5);
        keyLight.position.set(3, 4, 5);
        keyLight.castShadow = true;
        scene.add(keyLight);

        const fillLight = new THREE.DirectionalLight(0xddeeff, 1.2);
        fillLight.position.set(-3, 2, -2);
        scene.add(fillLight);

        const rimLight = new THREE.DirectionalLight(0xffffff, 0.8);
        rimLight.position.set(0, -1, -3);
        scene.add(rimLight);

        // Fish setup
        const fishMixers = [];
        const fishModels = [];
        const fishSpeed = 0.25;
        const swimRadius = 1.6;

        const fishPaths = [
            { scale: 2.8, yOffset: 0,     phase: 0 },
            { scale: 2.0, yOffset: 0.3,   phase: -0.6 },
            { scale: 1.4, yOffset: -0.25, phase: -1.1 },
        ];

        const loader = new GLTFLoader();
        loader.load('assets/clown_fish_low_poly_animated.glb', (gltf) => {
            const swimClip = gltf.animations.find(c => c.name === 'swim');
            if (swimClip) {
                swimClip.resetDuration();
                const minTime = swimClip.tracks.reduce((m, t) => Math.min(m, t.times[0]), Infinity);
                if (minTime > 0) {
                    swimClip.tracks.forEach(t => {
                        for (let i = 0; i < t.times.length; i++) t.times[i] -= minTime;
                    });
                    swimClip.resetDuration();
                }
            }

            fishPaths.forEach((fp, idx) => {
                const model = idx === 0 ? gltf.scene : SkeletonUtils.clone(gltf.scene);
                model.scale.setScalar(fp.scale);
                model.traverse(c => { if (c.isMesh) { c.castShadow = true; c.receiveShadow = true; } });
                scene.add(model);
                fishModels.push(model);

                if (swimClip) {
                    const mixer = new THREE.AnimationMixer(model);
                    const action = mixer.clipAction(swimClip.clone());
                    action.setLoop(THREE.LoopRepeat, Infinity);
                    action.timeScale = 0.5 + idx * 0.1;
                    action.play();
                    fishMixers.push(mixer);
                }
            });
        });

        const clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const delta = clock.getDelta();
            const elapsed = clock.elapsedTime;

            fishMixers.forEach(m => m.update(delta));
            fishModels.forEach((model, i) => {
                const fp = fishPaths[i];
                const t = elapsed * fishSpeed + fp.phase;
                const x = Math.cos(t) * swimRadius;
                const z = Math.sin(t) * swimRadius * 0.5;
                model.position.set(x, fp.yOffset, z);
                model.rotation.y = Math.atan2(-Math.sin(t) * swimRadius, Math.cos(t) * swimRadius * 0.5);
                model.rotation.z = Math.sin(t) * 0.04;
            });

            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
